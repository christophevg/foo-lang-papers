\documentclass[conference]{IEEEtran}
\usepackage[pdftex]{graphicx}
\usepackage[cmex10]{amsmath}
\interdisplaylinepenalty=2500
\usepackage{algorithmic}
\usepackage{array}
\usepackage{mdwmath}
\usepackage{mdwtab}
\usepackage{eqparbox}
\usepackage[font=footnotesize]{subfig}
\usepackage{fixltx2e}
\usepackage{url}
\hyphenation{}

% additional packages and utility commands
\usepackage{minted}
\usepackage{flushend}

\usepackage{lineno}
\setlength\linenumbersep{1mm}
\linenumbers

\begin{document}

% to avoid syntax error highlighting - e.g. foo's not js ;-)
\expandafter\def\csname PY@tok@err\endcsname{}

\title{Efficiently Detecting Intrusions\\in the Internet of Things}

\author{\IEEEauthorblockN{Christophe Van Ginneken, Jef Maerien, Christophe
Huygens, Danny Hughes, Wouter Joosen}%
\IEEEauthorblockA{iMinds-DistriNet, KU Leuven\\
3001 Leuven, Belgium\\
\{firstname.lastname\}@cs.kuleuven.be}}

\maketitle

\begin{abstract}

Supporting multiple intrusion detection (ID) algorithms imposes significant
overhead on Internet of Things (IoT) devices. Fusion of the underlying
algorithms can alleviate this, yet, proves to be time-consuming, repetitive and
error-prone. To address this problem we introduce id-foo, a framework for the
development of efficient intrusion detection systems (IDS). It consists of a
domain specific language (DSL) that allows describing ID algorithms in a formal
and functional way. The id-foo code generator then fuses these algorithms on a
functional level and produces more optimally organised source code. A
side-by-side comparison shows that id-foo-based code significantly reduces
memory footprint, message passing overhead and execution time in comparison to
a straightforward and sequential implementation of the same algorithms.

\end{abstract}

\section{Introduction}

% context

The promise of the Internet of Things (IoT) is exciting. Soon my car will
notify the central heating system at home that I will be late, due to
unforeseen heavy traffic. It now can turn up the heat a bit later, thus
lowering my energy bills and adding to a greener world. Wonderful, I'm in.

But what if the energy company is capable of doing the same? What if they
decide to turn up the heat while I'm gone, making my home nice and cosy but
also cranking up my bill and their profit. No thank you, let me out.

Along with all the wonderful possibilities, the IoT also holds an enormous
threat: by opening our homes and lives to all these interconnected devices, we
also open them to everyone who is technologically savvy enough to break these
new virtual locks, only now most of the time without a trace.

In classic (wired) networks, members of the network are protected by a firewall
that cleanses all traffic before it actually enters the local network.
Firewalls are primarily focusing on the actual network traffic, prohibiting
access to certain destinations and/or services. Attackers though often use
complicated strategies that abuse flaws in the actual services themselves. The
firewall can't see these, they pass the wall of fire unnoticed and deliver
their payload to the system under attack.

At that point it becomes important to know that something went wrong and if
possible how it went wrong. This information will at least enable us to learn
from the incident and prepare for future situations or correctly assess the
impact and mitigate it. This is where intrusion detection steps in. An
intrusion detection (ID) probe monitors all traffic that passes the firewall
and looks for known patterns. To do this, it typically gets a copied feed of
all traffic from the firewall. Often the intrusion detection system (IDS) also
has a feedback link to the firewall, enabling it to lock out the evildoer based
on its origin, but most of the time post-mortem.

In a wireless network however, it is not possible to have this single point in
the network that can oversee all traffic. Every node is uniquely addressable,
without the need to pass by any other node. So if the security perimeter
diminishes and every device stands on its own, every device will have to
implement its own lines of defence.

There is one upside to this situation though: with protection and ID present on
every device, the services running on those devices can take advantage of these
security layers. If the IDS detects a problem, the service can immediately
terminate the communication with the attacker, before it actually experiences
the consequences. Just like a firewall, the localised IDS actually can be a
layer between the hostile outside world and the software running on the device.

This integration will be a key point in development of security layers for IoT
devices. More than in a classic network IDS, the algorithms that try to
discover the attacks operate with a large degree of uncertainty. They also
often have to collaborate with other nearby devices in the network, to unmask
the culprit. This collaboration also increases the level of uncertainty,
because no other device can be fully trusted. In the end the IDS on an IoT
device will be able to provide information about the trust it puts in other
nodes in the network, but it will be up to some application-level policy to
decide what to do with this information.

% gap analysis

Current developments in this area focus on programming frameworks to structure
the implementation of different algorithms \cite{todo}, but don't offer a way
to optimise the usage of resources. They also don't support systematic reuse to
create different configurations for different nodes or evolution in time.
\cite{todo}.

% problem -> requirements for solution

The IoT is a very heterogeneous environment, both with respect to hardware and
software. Being able to address this in a transparent and automated way is a
key success factor for any kind of development in this area. For a
non-functional and generic layer, such as ID, this aspect becomes even more
paramount.

A solution that supports the integration of multiple algorithms and targets IoT
devices needs to consider the impact on the resources of these devices. These
devices not only need to survive using a limited battery, the production cost
should also taken into consideration. Different algorithms should be combined
as to avoid cumulating their impact.

% my approach (redundant -> contributions)

% This paper introduces id-foo, a framework that allows describing ID algorithms
% in a formal and functional way using a domain specific language (DSL). It also
% provides a code generator (CG) that employes functional code fusing (FCF) to
% produce source code that organises the source code in a more optimal way. This
% way it lowers the impact on memory usage, execution time and network usage.

% scientific contribution

The first contribution of this paper is a framework that enables the formal
description of ID algorithms on a functional level. Given these descriptions an
automated code generation process produces the corresponding source code, for a
given platform and configuration policy.

The second contribution is the application of functional code fusion (FCF)
during code generation. FCF identifies common data and functions and organises
the code in such a way that redundant iterations, tests and computations are
eliminated. Our results show substantially improved memory usage, execution
time and usage of the wireless network. All of these components add to the
reduction of energy and a longer battery life and therefore autonomy of the
device.

The final contribution is the unified integration of the generated IDS with the
actual software. All information from the different algorithms is centralised
and made available to the applications using an event-driven application
programming interface (API).

The remainder of this paper proceeds as follows: Section \ref{background}
details some of the ideas behind FCF and identifies the different aspects of
the problem space. Section \ref{design} describes the design we applied to
construct the framework, its language and code generator. Section
\ref{evaluation} evaluates an implementation and application of the domain
specific language (DSL) and code generator, using a set of ID algorithms found
in literature. Section \ref{related} explores related work in the field of ID
DSLs and code generation for the IoT. Finally, section \ref{conclusion}
summarises out findings, draws conclusions and identifies topics for future
work.

\section{Background}
\label{background}

Theory of Loop Fusion \cite{darte2000complexity}

Examples of code/loop fusion (e.g. Haskell Stream Fusion) \cite{coutts2007stream}

Function Inlining (e.g. TinyOS) \cite{gay2007software,gay2003nesc}

TODO

\section{Design}
\label{design}

TODO

\section{Evaluation}
\label{evaluation}

TODO

\section{Related Work}
\label{related}

IDS in WSN \cite{perrig2004security,mishra2004intrusion}

DSL \cite{fowler2010domain,mernik2005and}

DSL for WSN \cite{naumowicz2009prototyping,levis2004tinyscript}

DSL for IDS \cite{eckmann2002statl}

Code Generation for embedded systems/WSNs \cite{leupers2000code,marwedel2002code}

Code Optimization for embedded systems/WSNs \cite{panda2001data,naik2001software}

Code Generation for IDS \cite{charitakis2003code}

\section{Conclusion and Future Work}
\label{conclusion}

theoretical gains are met in practice

explore more domains + implement corresponding DSLs for embedded systems

extract generic language as host for DSLs

\section{Implementation and Evaluation}

network usages: number of packets, number of bytes

processing time

image size

TODO: memory usage ?

2 algorithms \cite{ganeriwal2008reputation}

TODO: add 3rd ? \cite{krontiris2009cooperative}


\section*{Acknowledgements}

This research is partially funded by the Interuniversity Attraction Poles
Programme Belgian State, Belgian Science Policy, and by the Research Fund KU
Leuven. This research is partially funded by the EU FP7 project NESSoS. We
would like to thank the reviewers for their thoughtful and helpful comments
that enhanced the readability of this paper. Our gratitude and respect also
goes out to all members of the NES task force at KU Leuven/DistriNet for
creating the nurturing environment where these ideas could grow.

\bibliographystyle{IEEEtran}
\bibliography{literature/referenties}

\end{document}
